# VF Woo Facebook RSS Feed

A production-ready WordPress plugin that generates a single XML RSS feed compatible with Facebook Catalog, which uses the Google Merchant Center RSS specification.

## Description

This plugin creates a public, cacheable endpoint that outputs an XML feed of your WooCommerce products, including variations. It's designed to be memory-efficient and performant, even on sites with a large number of products.

The feed is available at two URLs:
- Pretty Permalink: `https://your-domain.com/facebook-rss.xml` (recommended)
- Fallback Query: `https://your-domain.com/?vf_fb_feed=1`

## Features

- Includes simple products and product variations (as separate items).
- `g:item_group_id` connects variations to their parent product.
- Comprehensive settings page under **WooCommerce > Settings > Integration > VF Facebook RSS Feed**.
- Efficient, streamed XML generation to prevent memory exhaustion.
- Advanced caching with automatic invalidation when products or settings change.
- Support for conditional GETs (`304 Not Modified`) to save bandwidth.
- WP-CLI command for cache management and cron jobs.

## Installation

1.  Upload the `vf-woo-facebook-rss` folder to your `/wp-content/plugins/` directory.
2.  Activate the plugin through the 'Plugins' menu in WordPress.
3.  Go to **WooCommerce > Settings > Integration > VF Facebook RSS Feed** and configure the settings.
4.  Go to **Settings > Permalinks** and click "Save Changes" to flush your rewrite rules. This enables the `/facebook-rss.xml` endpoint.

## Usage

Once configured, the feed will be available at `https://your-domain.com/facebook-rss.xml`. You can use this URL to set up a product catalog in your Facebook Business Manager.

### Cache

The feed is cached for performance based on the TTL you set in the plugin settings. The cache is automatically cleared when you update a product or change the plugin's settings.

You can manually clear the cache in two ways:
1.  Click the **Regenerate Feed Now** button in the plugin's settings page.
2.  Visit the feed URL with a special parameter (you must be logged in as an administrator): `https://your-domain.com/facebook-rss.xml?flush=1&_wpnonce=...` (the correct nonce is generated by the button on the settings page).

### WP-CLI

You can also regenerate the feed from the command line, which is ideal for cron jobs.

**`wp vf-feed:generate`**

This command clears the existing cache and regenerates it.

Example:
```shell
# Regenerate the feed cache
$ wp vf-feed:generate
Clearing feed cache...
Success: Feed cache cleared.
Regenerating feed cache...
Success: Feed cache regenerated successfully.
The feed is available at: https://example.com/facebook-rss.xml
```
